<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://cdn.boxicons.com/fonts/basic/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ url_for('static', path='styles/style.css') }}">
    <title>Аудіосервер</title>
</head>
<body>
    <div class="modal hidden" id="authModal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2 id="formTitle">Авторизація</h2>
            <form id="authForm" method="post">
                <input type="text" name="username" placeholder="Username" required>
                <input type="email" name="email" placeholder="Email" id="emailField">
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Надіслати</button>
            </form>
        </div>
    </div>
    <header>
        <div class="search">
            <form action="/tracks/search" method="get">
                <input type="text" name="query" placeholder="Пошук">
                <button type="submit"><i class='bx  bx-search'  ></i></button>
            </form>
        </div>
        <div class="login">
            <div class="login">
                <div onclick="showModal('login')">Логін</div>
                <div onclick="showModal('register')">Реєстрація</div>
            </div>
        </div>
    </header>
    <div class="content">
        <h2>Upload audio</h2>
        <form action="/tracks/add" method="post" enctype="multipart/form-data">
            <input type="file" name="file" required>
            <button type="submit">Завантажити</button>
        </form>

        <h1>Список треків</h1>
        <ul>
            {% for track in tracks %}
                <li>
                    <strong>{{ track.title }}</strong>
                    <audio controls>
                        <source src="/tracks/play/{{ track.id }}" type="audio/mpeg">
                        Ваш браузер не підтримує аудіо.
                    </audio>
                    <form action="/tracks/delete/{{ track.id }}" method="post" style="display:inline;">
                        <button type="submit">Видалити</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    </div>

    <script>
        function showModal(type) {
            const modal = document.getElementById("authModal");
            const title = document.getElementById("formTitle");
            const form = document.getElementById("authForm");
            const emailField = document.getElementById("emailField");

            if (type === "login") {
                title.innerText = "Логін";
                emailField.style.display = "none";
                form.action = "/auth/login";
            } else {
                title.innerText = "Реєстрація";
                emailField.style.display = "block";
                form.action = "/auth/register";
            }

            modal.classList.remove("hidden");
        }

        function closeModal() {
            document.getElementById("authModal").classList.add("hidden");
        }
    </script>
</body>
</html>